<style>
  .anno{max-width:800;overflow:scroll;padding:10px;margin-top:10px;}
</style>
<br>
<button type="button" id="anno_button">Load All Annotations</button>
<div id="anno_results"></div>
<script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
<script type="text/jscript">
  var canvas_regex = /.+canvas\/([^.]+)/;

 
  $(document).ready(function(){
    $( "#anno_button" ).click(function() {
      $( "#anno_results" ).empty()
      for(var i =0; i < localStorage.length; i++){
        var key = localStorage.key(i);
        var matches = canvas_regex.exec(key);
        if(matches != null) {
          var canvas = matches[1];
          var fileName = canvas + '.json';
          var fileContent = localStorage.getItem(key);
          var jsonparse = JSON.parse(fileContent);
          $.ajax({
		    url: 'http://127.0.0.1:5000/annotations/',
		    dataType: 'json',
		    type: 'POST',
		    contentType: 'application/json',
		    data: JSON.stringify(jsonparse),
		    processData: false,
		    success: function( data, textStatus, jQxhr ){
		        $('#response pre').html( JSON.stringify( data ) );
		    },
		    error: function( jqXhr, textStatus, errorThrown ){
		        console.log( errorThrown );
		    }
		});
 
      }
  }
    });
 });
</script>
